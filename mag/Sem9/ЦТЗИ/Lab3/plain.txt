Стоимость POS-терминалов в зависимости от комплектации и возможностей может меняться от нескольких сотен до нескольких тысяч долларов, хотя обычно не превышает полутора–двух тысяч долларов. Размеры и вес POS-терминала сопостави-мы с аналогичными параметрами телефонного аппарата.
Схема системы POS приведена на рис. 9.4. Покупатель для оплаты покупки предъявляет свою дебетовую или кредитную карту и вводит значение PIN для подтверждения личности. Продавец, в свою очередь, вводит сумму денег, которую необходимо уплатить за покупку или услуги. Затем в банк-эквайер (банк продавца) направляется запрос на перевод денег. Банк-эквайер переадресует этот запрос в банк-эмитент для проверки подлинности карты, предъявленной покупателем. Если эта карта подлинная и покупатель имеет право применять ее для оплаты продуктов и услуг, банк-эмитент пере-водит деньги в банк-эквайер на счет продавца. После перевода денег на счет продавца банк-эквайер посылает на POS-терминал извещение, в котором сообщает о завершении транзакции. После этого продавец выдает покупателю товар и извещение.
Следует обратить внимание на тот сложный путь, который должна проделать информация о покупке, прежде чем будет осуществлена транзакция. Во время прохождения этого пути возможны искажения и потеря сообщений.
Для защиты системы POS должны выполняться следующие требования.
Проверка PIN, введенного покупателем, должна производиться системой банка-эмитента. При пересылке по каналам связи значение PIN должно быть зашифровано.
Сообщения, содержащие запрос на перевод денег (или подтверждение о переводе), должны проверяться на подлинность для защиты от замены и внесения изменений при прохождении по линиям связи и обрабатывающим процессорам [22].
Самым уязвимым местом системы POS являются ее POS-терминалы. В отличие от банкома-тов в этом случае изначально предполагается, что POS-терминал не защищен от внешних воздействий. Угрозы для POS-терминала связаны с возможностью раскрытия секретного ключа, который находится в POS-терминале и служит для шифрования информации, передаваемой этим терминалом в банк-эквайер. Угроза раскрытия ключа терминала достаточно реальна, так как эти терминалы устанавливаются в таких неохраняемых местах, как магазины, автозаправочные стан-ции и пр.
Потенциальные угрозы из-за раскрытия ключа получили такие названия.
"Обратное трассирование". Сущность этой угрозы состоит в том, что если злоумышленник полу-чит ключ шифрования, то он может пытаться восстановить значения PIN, использованные в пре-дыдущих транзакциях.
"Прямое трассирование". Сущность этой угрозы состоит в том, что если злоумышленник получит ключ шифрования, то он попытается восстановить значения PIN, которые будут использоваться в последующих транзакциях.
Для защиты от угроз обратного и прямого трассирования предложены три метода:
метод выведенного ключа;
метод ключа транзакции;
метод открытых ключей [22].
Сущность первых двух методов состоит в том, что они обеспечивают модификацию ключа шифрования передаваемых данных для каждой транзакции.
Метод выведенного ключа обеспечивает смену ключа при каждой транзакции независимо от ее содержания. Для генерации ключа шифрования используют однонаправленную функцию от теку-щего значения ключа и некоторой случайной величины. Процесс получения (вывода) ключа для шиф-рования очередной транзакции представляет собой известное "блуждание" по дереву (рис. 9.5).
Вершиной дерева рис. 9.5 являетс