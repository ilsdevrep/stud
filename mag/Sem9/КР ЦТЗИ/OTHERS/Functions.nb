(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63404,       1561]
NotebookOptionsPosition[     61873,       1535]
NotebookOutlinePosition[     62214,       1550]
CellTagsIndexPosition[     62171,       1547]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:0434\:043b\:044f \:0441\
\:043b\:043e\:0436\:0435\:043d\:0438\:044f \:0434\:0432\:0443\:0445 \:0442\
\:043e\:0447\:0435\:043a \:044d\:043b\:043b\:0438\:043f\:0442\:0438\:0447\
\:0435\:0441\:043a\:043e\:0439 \:043a\:0440\:0438\:043e\:0439", "Text",
 CellChangeTimes->{{3.7800175333704777`*^9, 
  3.780017553658609*^9}},ExpressionUUID->"0a5df797-6776-45cb-a80e-\
af2d54f1985e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EllipticAdd", "[", 
   RowBox[{
   "p_", ",", "a_", ",", "b_", ",", "c_", ",", "P_List", ",", "Q_List"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lam", ",", "x3", ",", "y3", ",", "P3"}], "}"}], ",", "\n", 
    "    ", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      StyleBox[
       RowBox[{"P", "==", 
        RowBox[{"{", "O", "}"}]}],
       FontColor->RGBColor[0, 0, 1]], ",", 
      StyleBox["Q",
       FontFamily->"Courier",
       FontSize->12,
       FontWeight->"Bold",
       FontSlant->"Plain",
       FontVariations->{"StrikeThrough"->False,
       "Underline"->False},
       FontColor->RGBColor[0, 0.500008, 0]], ",", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"Q", "==", 
        RowBox[{"{", "O", "}"}]}],
       FontColor->RGBColor[0, 0, 1]], ",", 
      StyleBox["P",
       FontFamily->"Courier",
       FontSize->12,
       FontWeight->"Bold",
       FontSlant->"Plain",
       FontVariations->{"StrikeThrough"->False,
       "Underline"->False},
       FontColor->RGBColor[0, 0.500008, 0]], ",", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "!=", 
        RowBox[{"Q", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}],
       FontColor->RGBColor[0, 0, 1]], ",", "\n", "\t\t  ", 
      RowBox[{
       RowBox[{"lam", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"P", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
           RowBox[{"PowerMod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"p", "-", "2"}], ",", "p"}], "]"}]}], ",", "p"}], 
         "]"}]}], ";", "\n", "\t\t  ", 
       RowBox[{"x3", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["lam", "2"], "-", "a", "-", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "p"}], "]"}]}], ";", "\n", 
       "\t\t  ", 
       RowBox[{"y3", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lam", 
              RowBox[{"(", 
               RowBox[{"x3", "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
             RowBox[{"P", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", "p"}], "]"}]}], 
       ";", "\n", "\t\t  ", 
       StyleBox[
        RowBox[{"{", 
         RowBox[{"x3", ",", "y3"}], "}"}],
        FontFamily->"Courier",
        FontSize->12,
        FontWeight->"Bold",
        FontSlant->"Plain",
        FontVariations->{"StrikeThrough"->False,
        "Underline"->False},
        FontColor->RGBColor[0, 0.500008, 0]]}], ",", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"P", "==", "Q"}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ")"}]}],
       FontColor->RGBColor[0, 0, 1]], ",", 
      StyleBox[
       RowBox[{"{", "O", "}"}],
       FontFamily->"Courier",
       FontSize->12,
       FontWeight->"Bold",
       FontSlant->"Plain",
       FontVariations->{"StrikeThrough"->False,
       "Underline"->False},
       FontColor->RGBColor[0, 0.500008, 0]], 
      StyleBox[",",
       FontFamily->"Courier",
       FontSize->12,
       FontWeight->"Bold",
       FontSlant->"Plain",
       FontVariations->{"StrikeThrough"->False,
       "Underline"->False},
       FontColor->RGBColor[0, 0.500008, 0]], "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"P", "==", "Q"}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{"P", "!=", 
          RowBox[{"{", "O", "}"}]}], ")"}]}],
       FontColor->RGBColor[0, 0, 1]], ",", "\n", "\t\t ", 
      RowBox[{
       RowBox[{"lam", "=", 
        RowBox[{"Mod", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "*", 
              SuperscriptBox[
               RowBox[{"P", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "2"]}], "+", 
             RowBox[{"2", "a", "*", 
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", "b"}], ")"}], 
           RowBox[{"PowerMod", "[", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"P", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"p", "-", "2"}], ",", "p"}], "]"}]}], ",", "p"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "  \t  ", 
       RowBox[{"x3", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["lam", "2"], "-", "a", "-", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"Q", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "p"}], "]"}]}], ";", "\n", 
       "\t\t  ", 
       RowBox[{"y3", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lam", 
              RowBox[{"(", 
               RowBox[{"x3", "-", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "+", 
             RowBox[{"P", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ",", "p"}], "]"}]}], 
       ";", "\n", "\t\t  ", 
       StyleBox[
        RowBox[{"{", 
         RowBox[{"x3", ",", "y3"}], "}"}],
        FontFamily->"Courier",
        FontSize->12,
        FontWeight->"Bold",
        FontSlant->"Plain",
        FontVariations->{"StrikeThrough"->False,
        "Underline"->False},
        FontColor->RGBColor[0, 0.500008, 0]]}], ",", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "!=", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}],
       FontColor->RGBColor[0, 0, 1]], ",", 
      StyleBox[
       RowBox[{"{", "O", "}"}],
       FontFamily->"Courier",
       FontSize->12,
       FontWeight->"Bold",
       FontSlant->"Plain",
       FontVariations->{"StrikeThrough"->False,
       "Underline"->False},
       FontColor->RGBColor[0, 0.500008, 0]]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"147384ef-a799-43af-86bc-ddb0d74a076c"],

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:0434\:043b\:044f \:043f\
\:043e\:0438\:0441\:043a\:0430 \:0431\:0430\:0437\:043e\:0432\:043e\:0439 \
\:0442\:043e\:0447\:043a\:0438", "Text",
 CellChangeTimes->{{3.7800175806519413`*^9, 
  3.780017602446576*^9}},ExpressionUUID->"5467a3ed-b619-41fe-aa87-\
c54ebd4dfabc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SearchPoint", "[", 
   RowBox[{
   "p0_", ",", "a0_", ",", "b0_", ",", "c0_", ",", "xm_", ",", "rm_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "=", "p0"}], ",", 
      RowBox[{"a", "=", "a0"}], ",", 
      RowBox[{"b", "=", "b0"}], ",", 
      RowBox[{"c", "=", "c0"}], ",", 
      RowBox[{"XMin", "=", "xm"}], ",", 
      RowBox[{"RankMin", "=", "rm"}], ",", "found", ",", "x1", ",", "y1", ",",
       "i", ",", "r", ",", "try", ",", "y", ",", "tP", ",", "P", ",", "P1", 
      ",", "A", ",", "s", ",", "flag", ",", "t", ",", "rank"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"found", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x1", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Round", "[", 
         RowBox[{"p", "+", "1", "+", 
          RowBox[{"2", "*", 
           RowBox[{"Sqrt", "[", "p", "]"}]}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"found", "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"b", "^", "3"}]}], "+", 
              RowBox[{"27", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"c", "+", "i"}], ")"}], "^", "2"}]}]}], ",", "p"}], 
            "]"}], "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<\:041a\:0440\:0438\:0432\:0430\:044f y^2=x^3+\>\"", ",", 
              "a", ",", "\"\<*x^2+\>\"", ",", "b", ",", "\"\<*x+\>\"", ",", 
              "c", ",", "\"\<+\>\"", ",", "i", ",", 
              "\"\< - \:0433\:043b\:0430\:0434\:043a\:0430\:044f\>\""}], 
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x1", "=", "XMin"}], ";", 
           RowBox[{"try", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"try", "<", "40"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"found", "\[Equal]", "False"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"y", "^", "2"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"x1", "^", "3"}], "+", 
                    RowBox[{"a", "*", 
                    RowBox[{"x1", "^", "2"}]}], "+", 
                    RowBox[{"b", "*", "x1"}], "+", "c", "+", "i"}]}], ",", 
                   RowBox[{"{", "y", "}"}], ",", 
                   RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}], 
                 "\[NotEqual]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"y1", "=", 
                  RowBox[{"y", "/.", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"y", "^", "2"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"x1", "^", "3"}], "+", 
                    RowBox[{"a", "*", 
                    RowBox[{"x1", "^", "2"}]}], "+", 
                    RowBox[{"b", "*", "x1"}], "+", "c", "+", "i"}]}], ",", 
                    RowBox[{"{", "y", "}"}], ",", 
                    RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}], ",", "1"}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"tP", "=", 
                  RowBox[{"{", "}"}]}], ";", 
                 RowBox[{"P", "=", 
                  RowBox[{"{", 
                   RowBox[{"x1", ",", "y1"}], "}"}]}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"tP", ",", "P"}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"P", "=", 
                    RowBox[{"EllipticAdd", "[", 
                    RowBox[{"p", ",", "a", ",", "b", ",", 
                    RowBox[{"c", "+", "i"}], ",", 
                    RowBox[{"tP", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "P"}], "]"}]}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"tP", ",", "P"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"l", ",", "2", ",", "r"}], "}"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"P1", "=", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"tP", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], ",", "p"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"A", "=", 
                  RowBox[{"{", "O", "}"}]}], ";", 
                 RowBox[{"s", "=", "0"}], ";", 
                 RowBox[{"flag", "=", "True"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"While", "[", 
                  RowBox[{"flag", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"A", "=", 
                    RowBox[{"EllipticAdd", "[", 
                    RowBox[{"p", ",", "a", ",", "b", ",", 
                    RowBox[{"c", "+", "i"}], ",", "P1", ",", "A"}], "]"}]}], 
                    ";", 
                    RowBox[{"s", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"t", "=", "1"}], ",", 
                    RowBox[{"t", "\[LessEqual]", "r"}], ",", 
                    RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tP", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "\[Equal]", "A"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"flag", "=", "False"}], ";", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"rank", "=", 
                  RowBox[{
                   RowBox[{"r", "*", "s"}], "+", "t"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Which", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"rank", ">", "RankMin"}], " ", "&&", " ", 
                    RowBox[{"PrimeQ", "[", "rank", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<\:041d\:0430\:0439\:0434\:0435\:043d\:0430 \:0431\
\:0430\:0437\:043e\:0432\:0430\:044f \:0442\:043e\:0447\:043a\:0430 P=\>\"", 
                    ",", 
                    RowBox[{"tP", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\"\<. \n\:041a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\
\:0442\:0430 x=\>\"", ",", "x1", ",", "\"\< \[GreaterEqual] Floor[p/2]=\>\"", 
                    ",", "XMin", ",", 
                    "\"\<.\n\:041f\:043e\:0440\:044f\:0434\:043e\:043a \:0442\
\:043e\:0447\:043a\:0438=\>\"", ",", "rank", ",", 
                    "\"\< \[GreaterEqual] 2p/3=\>\"", ",", "RankMin", ",", 
                    "\"\< \:0438 \:044f\:0432\:043b\:044f\:0435\:0442\:0441\
\:044f \:043f\:0440\:043e\:0441\:0442\:044b\:043c \:0447\:0438\:0441\:043b\
\:043e\:043c. \n\:042d\:043b\:043b\:0438\:043f\:0442\:0438\:0447\:0435\:0441\
\:043a\:0430\:044f \:043a\:0440\:0438\:0432\:0430\:044f y^2=x^3+\>\"", ",", 
                    "a", ",", "\"\<*x^2+\>\"", ",", "b", ",", "\"\<*x+\>\"", 
                    ",", 
                    RowBox[{"c", "+", "i"}], ",", 
                    "\"\< - \:0433\:043b\:0430\:0434\:043a\:0430\:044f. \
i=\>\"", ",", "i"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"found", "=", "True"}], ";"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"rank", ">", "RankMin"}], " ", "&&", " ", 
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{"PrimeQ", "[", "rank", "]"}], ")"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<\:041d\:0430\:0439\:0434\:0435\:043d\:0430  \:0442\
\:043e\:0447\:043a\:0430 P = \>\"", ",", 
                    RowBox[{"tP", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\"\<. \:041f\:043e\:0440\:044f\:0434\:043e\:043a = \>\"",
                     ",", "rank", ",", 
                    "\"\< \:043d\:0435 \:044f\:0432\:043b\:044f\:0435\:0442\
\:0441\:044f \:043f\:0440\:043e\:0441\:0442\:044b\:043c \:0447\:0438\:0441\
\:043b\:043e\:043c. i = \>\"", ",", "i"}], "]"}], ";"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x1", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"try", "++"}], ";"}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rank", "\[LessEqual]", "RankMin"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<\:041d\:0430\:0439\:0434\:0435\:043d\:0430  \:0442\
\:043e\:0447\:043a\:0430 P = \>\"", ",", 
                    RowBox[{"tP", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    "\"\<. \:041f\:043e\:0440\:044f\:0434\:043e\:043a = \>\"",
                     ",", "rank", ",", "\"\< < 2p/3. i = \>\"", ",", "i"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x1", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"try", "++"}], ";"}], "}"}]}], "]"}], ";"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "\:0422\:043e\:0447\:043a\:0430", " ", "\:043d\:0435", " ", 
                  "\:043f\:0440\:0438\:043d\:0430\:0434\:043b\:0435\:0436\
\:0438\:0442", " ", 
                  RowBox[{"\:043a\:0440\:0438\:0432\:043e\:0439", "."}]}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"x1", "++"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"try", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}],
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<\:041a\:0440\:0438\:0432\:0430\:044f y^2=x^3+\>\"", ",", 
              "a", ",", "\"\<*x^2+\>\"", ",", "b", ",", "\"\<*x+\>\"", ",", 
              "c", ",", "\"\<+\>\"", ",", "i", ",", 
              "\"\< - \:043d\:0435 \:0433\:043b\:0430\:0434\:043a\:0430\:044f\
\>\""}], "]"}], ";"}]}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "++"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7798672238805976`*^9, 3.7798674340089626`*^9}, {
  3.7798677870836325`*^9, 3.779867798237259*^9}, {3.779885321319336*^9, 
  3.779885329895473*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a512d29f-7a75-42b1-924d-1e915e6da8d8"],

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:0434\:043b\:044f \:0443\
\:043c\:043d\:043e\:0436\:0435\:043d\:0438\:044f \:0442\:043e\:0447\:043a\
\:0438 \:043d\:0430 \:0446\:0435\:043b\:043e\:0435 \:0447\:0438\:0441\:043b\
\:043e", "Text",
 CellChangeTimes->{{3.7800176604008684`*^9, 
  3.780017670135722*^9}},ExpressionUUID->"b88f586a-2f60-49cd-a36e-\
4c2599afea70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nsum", "[", 
    RowBox[{
    "p1_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "t_", ",", "n1_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", "p1"}], ",", 
       RowBox[{"a", "=", "a1"}], ",", 
       RowBox[{"b", "=", "b1"}], ",", 
       RowBox[{"e", "=", "t"}], ",", 
       RowBox[{"c", "=", "c1"}], ",", 
       RowBox[{"n", "=", "n1"}], ",", "q1", ",", "q"}], "}"}], ",", 
     RowBox[{
      RowBox[{"q", "=", "e"}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"q1", "=", 
           RowBox[{"EllipticAdd", "[", 
            RowBox[{"p", ",", "a", ",", "b", ",", "c", ",", "e", ",", "q"}], 
            "]"}]}], ",", 
          RowBox[{"q", "=", "q1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", "q"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7800200497329016`*^9, 3.78002005373046*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"4c099512-6c28-4382-a1fb-65191e0e99ef"],

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:0433\:0435\:043d\:0435\
\:0440\:0430\:0446\:0438\:0438 \:042d\:0426\:041f \:043f\:043e \:0430\:043b\
\:0433\:043e\:0440\:0438\:0442\:043c\:0443 ECDSA", "Text",
 CellChangeTimes->{{3.7800176752078333`*^9, 
  3.7800176913636107`*^9}},ExpressionUUID->"de4c854d-f59d-4f87-8e75-\
e5410df9d199"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ECDSAGenerateSign", "[", 
   RowBox[{
   "p0_", ",", "a0_", ",", "b0_", ",", "c0_", ",", "P0_", ",", "q0_", ",", 
    "m0_", ",", "sk0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "=", "p0"}], ",", 
      RowBox[{"a", "=", "a0"}], ",", 
      RowBox[{"b", "=", "b0"}], ",", 
      RowBox[{"ci", "=", "c0"}], ",", 
      RowBox[{"P", "=", "P0"}], ",", 
      RowBox[{"q", "=", "q0"}], ",", 
      RowBox[{"m", "=", "m0"}], ",", 
      RowBox[{"s", "=", "sk0"}], ",", "k", ",", "R", ",", "r", ",", "e", ",", 
      "d", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"q", "-", "2"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"Nsum", "[", 
       RowBox[{"p", ",", "a", ",", "b", ",", "ci", ",", "P", ",", "k"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "q"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e", "=", 
      RowBox[{"FileHash", "[", 
       RowBox[{"m", ",", "\"\<MD5\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"PowerMod", "[", 
       RowBox[{"k", ",", 
        RowBox[{"-", "1"}], ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"d", "*", 
         RowBox[{"(", 
          RowBox[{"e", "+", 
           RowBox[{"s", "*", "r"}]}], ")"}]}], ",", "q"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"r", ",", "c"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7798846705920887`*^9, 3.7798846754034777`*^9}, {
  3.7800225608249607`*^9, 3.7800225621911545`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"5b54f902-3ef4-4a6f-8843-b652f857ba47"],

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:043f\:0440\:043e\:0432\
\:0435\:0440\:043a\:0438 \:042d\:0426\:041f, \:0441\:0433\:0435\:043d\:0435\
\:0440\:0438\:0440\:043e\:0432\:0430\:043d\:043d\:043e\:0439 \:043f\:043e \
\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:0443 ECDSA", "Text",
 CellChangeTimes->{{3.7800176950727577`*^9, 3.7800176967684126`*^9}, {
   3.7800177939319353`*^9, 3.780017815307968*^9}, 
   3.78426366714019*^9},ExpressionUUID->"832a1aff-0593-4f52-811f-\
5e6f432768aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ECDSAVerificateSign", "[", 
   RowBox[{
   "p0_", ",", "a0_", ",", "b0_", ",", "c0_", ",", "P0_", ",", "q0_", ",", 
    "m0_", ",", "Q0_", ",", "sign0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "=", "p0"}], ",", 
      RowBox[{"a", "=", "a0"}], ",", 
      RowBox[{"b", "=", "b0"}], ",", 
      RowBox[{"ci", "=", "c0"}], ",", 
      RowBox[{"P", "=", "P0"}], ",", 
      RowBox[{"q", "=", "q0"}], ",", 
      RowBox[{"m1", "=", "m0"}], ",", 
      RowBox[{"Q", "=", "Q0"}], ",", 
      RowBox[{"sign", "=", "sign0"}], ",", "W", ",", "e1", ",", "U1", ",", 
      "U2", ",", "U1P", ",", "U2Q", ",", "R1", ",", "r1", ",", "c1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r1", "=", 
      RowBox[{"sign", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"c1", "=", 
      RowBox[{"sign", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "<", "r1", "<", 
          RowBox[{"q", "-", "1"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"1", "<", "c1", "<", 
          RowBox[{"q", "-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"W", "=", 
         RowBox[{"PowerMod", "[", 
          RowBox[{"c1", ",", 
           RowBox[{"-", "1"}], ",", "q"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"e1", "=", 
         RowBox[{"FileHash", "[", 
          RowBox[{"m1", ",", "\"\<MD5\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"U1", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"W", "*", "e1"}], ",", "q"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"U2", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"W", "*", "r1"}], ",", "q"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"U1P", "=", 
         RowBox[{"Nsum", "[", 
          RowBox[{"p", ",", "a", ",", "b", ",", "ci", ",", "P", ",", "U1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"U2Q", "=", 
         RowBox[{"Nsum", "[", 
          RowBox[{"p", ",", "a", ",", "b", ",", "ci", ",", "Q", ",", "U2"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"R1", "=", 
         RowBox[{"EllipticAdd", "[", 
          RowBox[{
          "p", ",", "a", ",", "b", ",", "ci", ",", "U1P", ",", "U2Q"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"R1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "r1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<\:041f\:043e\:0434\:043f\:0438\:0441\:044c \:0432\:0435\:0440\
\:043d\:0430\>\"", "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{
          "Print", "[", 
           "\"\<\:041f\:043e\:0434\:043f\:0438\:0441\:044c \:043d\:0435 \
\:0432\:0435\:0440\:043d\:0430\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<\:0423\:0441\:043b\:043e\:0432\:0438\:0435 \:043d\:0435 \:0432\
\:044b\:043f\:043e\:043b\:043d\:0435\:043d\:043e\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7798846793242435`*^9, 3.7798846848231263`*^9}, {
   3.7800212394596653`*^9, 3.7800213209080763`*^9}, 3.780021452897221*^9, {
   3.78002150378658*^9, 3.780021519714818*^9}, {3.78002155408768*^9, 
   3.7800215937182865`*^9}, {3.7800225645497847`*^9, 3.780022569610299*^9}, {
   3.780023637229249*^9, 3.7800236374435825`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"a7a46304-2389-4bbf-9896-fa788dbcf092"],

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:0434\:043b\:044f \:0432\
\:0441\:0442\:0440\:0430\:0438\:0432\:0430\:043d\:0438\:044f \:0426\:0412\
\:0417 \:0432 \:0438\:0437\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\
\:0435", "Text",
 CellChangeTimes->{{3.784263669156839*^9, 
  3.7842636869751835`*^9}},ExpressionUUID->"4eefed9c-d99a-49ee-9383-\
0d763e259916"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InsertDW", "[", 
   RowBox[{"img0_", ",", "stroka0_", ",", "random0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"img", "=", "img0"}], ",", 
      RowBox[{"stroka", "=", "stroka0"}], ",", 
      RowBox[{"randomNum", "=", "random0"}], ",", "size", ",", "digWatermark",
       ",", "img1", ",", "height", ",", "width", ",", "end", ",", "end1", ",",
       "end2", ",", "a", ",", "b", ",", "ImgR", ",", "ImgG", ",", "ImgB", ",",
       "l", ",", "km", ",", "q", ",", "i", ",", "j", ",", "row", ",", "col", 
      ",", "rgb", ",", "rgbcomb", ",", "imgFinal"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "(*", "\:0421\:0442\:0435\:0433\:043e\:043f\:0443\:0442\:044c", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"size", "=", 
      RowBox[{"ImageDimensions", "[", "img", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stroka", "=", 
      RowBox[{"ToCharacterCode", "[", "stroka", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"digWatermark", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"IntegerDigits", "[", 
        RowBox[{"stroka", ",", "2", ",", "11"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"img1", "=", 
      RowBox[{"ImagePartition", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"height", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dimensions", "[", "img1", "]"}], "}"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"width", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dimensions", "[", "img1", "]"}], "}"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "\:0434\:043e\:0431\:0430\:0432\:0438\:0442\:044c", " ", "\:0432", " ", 
       "\:043a\:043e\:043d\:0435\:0446", " ", "11", " ", 
       "\:0435\:0434\:0438\:043d\:0438\:0446"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"end2", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{
           RowBox[{"StringLength", "[", 
            RowBox[{"FromCharacterCode", "[", "stroka", "]"}], "]"}], ",", 
           "2"}], "]"}], ",", "11"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"end1", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", 
          RowBox[{"208", ",", "2"}], "]"}], ",", "11"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"end", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", "11", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"digWatermark", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"digWatermark", ",", "end2", ",", "end1", ",", "end"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "digWatermark", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "(*", "\:0412\:0441\:0442\:0440\:0430\:0438\:0432\:0430\:043d\:0438\:0435\
", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "randomNum", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "height"}], "}"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"(*", "\:0441\:0442\:0440\:043e\:043a\:0430", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "width"}], "}"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"(*", "\:0441\:0442\:043e\:043b\:0431\:0435\:0446", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"height", "-", 
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}], "+", 
         RowBox[{"height", "*", 
          RowBox[{"(", 
           RowBox[{"width", "-", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}]}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"height", "-", 
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "+", 
         RowBox[{"height", "*", 
          RowBox[{"(", 
           RowBox[{"width", "-", 
            RowBox[{"b", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "!=", 
        RowBox[{
         RowBox[{"Length", "[", "digWatermark", "]"}], "+", "110"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "height"}], "}"}], ",", "1"}], "]"}]}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "width"}], "}"}], ",", "1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
         RowBox[{"b", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"height", "-", 
            RowBox[{"a", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "+", 
          RowBox[{"height", "*", 
           RowBox[{"(", 
            RowBox[{"width", "-", 
             RowBox[{"b", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ImgR", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "digWatermark", "]"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"ImgG", "=", "ImgR"}], ";", 
     RowBox[{"ImgB", "=", "ImgR"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"l", "<", 
         RowBox[{"Length", "[", "digWatermark", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"i", "\[LessEqual]", "height"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ImgR", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "=", 
             RowBox[{"ImageData", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ColorSeparate", "[", 
                 RowBox[{"img1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Byte\>\""}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ImgG", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "=", 
             RowBox[{"ImageData", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ColorSeparate", "[", 
                 RowBox[{"img1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Byte\>\""}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ImgB", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "=", 
             RowBox[{"ImageData", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ColorSeparate", "[", 
                 RowBox[{"img1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<Byte\>\""}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"l", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"l", ">", 
               RowBox[{"Length", "[", "digWatermark", "]"}]}], ",", 
              RowBox[{
               RowBox[{"Print", "[", "\"\<>\>\"", "]"}], ";", 
               RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
            RowBox[{"i", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"i", "=", "1"}], ";", 
         RowBox[{"j", "++"}]}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Print", "[", 
        RowBox[{
        "l", ",", "\"\< \>\"", ",", "i", ",", "\"\< \>\"", ",", "j", ",", 
         "\"\< \>\"", ",", "cv"}], "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:0434\:043b\:044f", " ", "\:043a\:0430\:043d\:0430\:043b\:0430", 
         " ", "G", " ", 
         "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:0435",
          " ", "\:0441\:0443\:043c\:043c\:044b"}], ",", " ", 
        RowBox[{"\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430", " ", 
         RowBox[{
         "\:0447\:0435\:0442\:043d\:043e\:0441\:0442\:0438", ".", " ", 
          "\:0438\:0437\:043c\:0435\:043d\:0435\:043d\:0438\:0435"}], " ", 
         "\:0447\:0435\:0442\:043d\:043e\:0441\:0442\:0438", " ", 
         "\:0431\:043b\:043e\:043a\:0430", " ", "\:0432", " ", 
         "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\:0432\:0438\
\:0438", " ", "\:0441", " ", 
         "\:0438\:043d\:0444\:043e\:0440\:043c\:0430\:0446\:0438\:0435\:0439",
          " ", "\:0432", " ", "\:0431\:0438\:0442\:0435", " ", 
         "\:0426\:0412\:0417"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"ImgG", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"row", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"col", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"!", 
              RowBox[{"Divisible", "[", 
               RowBox[{"q", ",", "2"}], "]"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"digWatermark", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "\[Equal]", "0"}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{"ImgG", "[", 
             RowBox[{"[", 
              RowBox[{"y", ",", "row", ",", "col"}], "]"}], "]"}], "=", 
            RowBox[{"BitXor", "[", 
             RowBox[{
              RowBox[{"ImgG", "[", 
               RowBox[{"[", 
                RowBox[{"y", ",", "row", ",", "col"}], "]"}], "]"}], ",", 
              "1"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Divisible", "[", 
              RowBox[{"q", ",", "2"}], "]"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"digWatermark", "[", 
               RowBox[{"[", "y", "]"}], "]"}], "\[Equal]", "1"}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"ImgG", "[", 
              RowBox[{"[", 
               RowBox[{"y", ",", "col", ",", "row"}], "]"}], "]"}], "=", 
             RowBox[{"BitXor", "[", 
              RowBox[{
               RowBox[{"ImgG", "[", 
                RowBox[{"[", 
                 RowBox[{"y", ",", "col", ",", "row"}], "]"}], "]"}], ",", 
               "1"}], "]"}]}], ";"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1", ",", "\[IndentingNewLine]", 
          RowBox[{"Length", "[", "digWatermark", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:043c\:043e\:0434\:0438\:0444\:0438\:0446", " ", 
       "b\:0440\:043e\:0432\:0430\:043d\:0438\:0435", " ", 
       "\:0431\:043b\:043e\:043a\:043e\:0432"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rgb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "digWatermark", "]"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rgbcomb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "digWatermark", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"rgb", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Image", "[", 
            RowBox[{
             RowBox[{"ImgR", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Byte\>\"", ",", 
             RowBox[{"ImageSize", "\[Rule]", "2"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rgb", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Image", "[", 
            RowBox[{
             RowBox[{"ImgG", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Byte\>\"", ",", 
             RowBox[{"ImageSize", "\[Rule]", "2"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rgb", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Image", "[", 
            RowBox[{
             RowBox[{"ImgB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Byte\>\"", ",", 
             RowBox[{"ImageSize", "\[Rule]", "2"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "digWatermark", "]"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rgbcomb", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"ColorCombine", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rgb", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"rgb", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"rgb", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
          "\"\<RGB\>\""}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "digWatermark", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0441\:043e\:0437\:0434\:0430\:043d\:0438\:0435", " ", 
       "\:043d\:043e\:0432\:043e\:0433\:043e", " ", 
       "\:0438\:0437\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\:044f", 
       " ", "\:0438\:0437", " ", 
       "\:043c\:043e\:0434\:0438\:0444\:0438\:0446\:0438\:0440\:043e\:0432\
\:0432\:0430\:043d\:043d\:044b\:0445", " ", 
       "\:0434\:0430\:043d\:043d\:044b\:0445"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"l", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", 
      RowBox[{"b", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", 
     RowBox[{"i", "=", 
      RowBox[{"a", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"l", "<", 
        RowBox[{"Length", "[", "digWatermark", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"i", "\[LessEqual]", "height"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"img1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"rgbcomb", "[", 
             RowBox[{"[", "l", "]"}], "]"}]}], ";", 
           RowBox[{"l", "++"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"l", ">", 
              RowBox[{"Length", "[", "digWatermark", "]"}]}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
           RowBox[{"i", "++"}]}]}], "]"}], ";", 
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"imgFinal", "=", 
      RowBox[{"ImageAssemble", "[", "img1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<c:\\\\1\\\\pic3n.bmp\>\"", ",", "imgFinal"}], "]"}], ";", 
     "\[IndentingNewLine]", "imgFinal"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"1b29c734-6af2-4b35-b716-380160bab11b"],

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:044f \:043f\:043e\:0438\:0441\
\:043a\:0430 \:0426\:0412\:0417 \:0432 \:0438\:0437\:043e\:0431\:0440\:0430\
\:0436\:0435\:043d\:0438\:0438", "Text",
 CellChangeTimes->{{3.7842636953352604`*^9, 
  3.7842637101651025`*^9}},ExpressionUUID->"b5050101-69de-43fa-927f-\
8b08c53bb1b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindDW", "[", 
   RowBox[{"imgV0_", ",", "random0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"imgV", "=", "imgV0"}], ",", 
      RowBox[{"randomNum", "=", "random0"}], ",", "imgV1", ",", "height", ",",
       "width", ",", "vf", ",", "a", ",", "b", ",", "j", ",", "i", ",", "vV", 
      ",", "s", ",", "km", ",", "ImgG", ",", "q", ",", "strokalen"}], "}"}], 
    ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"imgV", "=", 
       RowBox[{"Import", "[", "\"\<C:\\\\1\\\\pic3n.bmp\>\"", "]"}]}], ";"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgV1", "=", 
      RowBox[{"ImagePartition", "[", 
       RowBox[{"imgV", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"height", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dimensions", "[", "imgV1", "]"}], "}"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"width", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Dimensions", "[", "imgV1", "]"}], "}"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"randNum", "=", "\"\<16048\>\""}], ";"}], 
      RowBox[{"(*", " ", 
       RowBox[{
       "\:0441\:043b\:043e\:0432\:043e", " ", "\:0434\:043b\:044f", " ", 
        "\:043d\:0430\:0441\:0442\:0440\:043e\:0439\:043a\:0438", " ", 
        "\:0433\:0435\:043d\:0435\:0440\:0430\:0442\:043e\:0440\:0430", "  ", 
        "\:0441\:043b\:0443\:0447\:0430\:0439\:043d\:044b\:0445", " ", 
        "\:0447\:0438\:0441\:0435\:043b"}], " ", "*)"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"vf", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "randomNum", "]"}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "\:043d\:0430\:0441\:0442\:0440\:043e\:0439\:043a\:0430", " ", 
       "\:0433\:0435\:043d\:0435\:0440\:0430\:0442\:043e\:0440\:0430", " ", 
       "\:0441\:043b\:0443\:0447\:0430\:0439\:043d\:044b\:0445", " ", 
       "\:0447\:0438\:0441\:0435\:043b"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"vf", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<1)\>\"", ",", "i", ",", "\"\< \>\"", ",", "j", ",", 
           "\"\< \>\"", ",", "km", ",", "\"\<  \>\"", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"h", "-", "i"}], ")"}], "+", 
            RowBox[{"h", "*", 
             RowBox[{"(", 
              RowBox[{"dl", "-", "j"}], ")"}]}]}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "height"}], "}"}], ",", "1"}], "]"}]}], ";", 
        RowBox[{"(*", "\:0441\:0442\:0440\:043e\:043a\:0430", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "width"}], "}"}], ",", "1"}], "]"}]}], ";", 
        RowBox[{"(*", "\:0441\:0442\:043e\:043b\:0431\:0435\:0446", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"b", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"i", "=", 
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<2)\>\"", ",", "i", ",", "\"\< \>\"", ",", "j", ",", 
            "\"\< \>\"", ",", "km"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vV", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"height", "*", "width"}], "+", "1"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"s", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"km", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"i", "=", "21"}], ";", 
          RowBox[{"j", "=", "32"}], ";", 
          RowBox[{"i", "=", "2"}], ";", 
          RowBox[{"j", "=", "31"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<3)\>\"", ",", "i", ",", "\"\< \>\"", ",", "j", ",", 
            "\"\< \>\"", ",", "km", ",", "\"\<  \>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"h", "-", "i"}], ")"}], "+", 
             RowBox[{"h", "*", 
              RowBox[{"(", 
               RowBox[{"dl", "-", "j"}], ")"}]}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "<", "width"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"i", "<=", "height"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ImgG", "=", 
               RowBox[{"ImageData", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ColorSeparate", "[", 
                   RowBox[{"imgV1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Byte\>\""}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"q", "=", "0"}], ";", 
              RowBox[{"q", "=", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"ImgG", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"Divisible", "[", 
                   RowBox[{"q", ",", "2"}], "]"}]}], ")"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vV", "[", 
                   RowBox[{"[", "km", "]"}], "]"}], "=", "1"}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"s", ",", "1"}], "]"}], ";"}], ",", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"s", ",", "0"}], "]"}], ";", 
                 RowBox[{
                  RowBox[{"vV", "[", 
                   RowBox[{"[", "km", "]"}], "]"}], "=", "0"}]}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", "s", "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"km", ">", "21"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", "km", ")"}], ",", "11"}], "]"}], "\[Equal]", 
                    "0"}], 
                   RowBox[{"(*", 
                    RowBox[{"&&", 
                    RowBox[{"s", "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
                    "}"}]}]}], "*)"}], "&&", 
                   RowBox[{"(*", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
                    ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", 
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
                     "*)"}], 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
                    ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
                    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
                     "\[Equal]", 
                    RowBox[{"vV", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"km", "-", "21"}], ";;", "km"}], "]"}], "]"}]}]}],
                   ",", 
                  RowBox[{
                   RowBox[{"j", "=", "width"}], ";", 
                   RowBox[{"vf", "=", "2"}], ";", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<4)\>\"", ",", "vf"}], "]"}], ";"}], "*)"}], 
                   RowBox[{"Break", "[", "]"}]}]}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"km", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"km", ",", "11"}], "]"}], "\[Equal]", "1"}], ",", 
                RowBox[{"s", "=", 
                 RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"i", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "++"}]}]}], "]"}], ";"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<5)\>\"", ",", 
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", 
          RowBox[{"b", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<vb\>\""}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<6)\>\"", ",", "i", ",", "\"\< \>\"", ",", "j", ",", "\"\< \>\"",
           ",", "km", ",", "\"\<  \>\"", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", "-", "i"}], ")"}], "+", 
           RowBox[{"h", "*", 
            RowBox[{"(", 
             RowBox[{"dl", "-", "j"}], ")"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"digWatermark", "==", 
          RowBox[{"vV", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "km"}], "]"}], "]"}]}], "]"}]}], "*)"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\:0432\:0430\
\:043d\:0438\:0435", " ", "\:0441\:043f\:0438\:0441\:043a\:0430", " ", "vV", 
       " ", "\:0432", " ", "\:0441\:0442\:0440\:043e\:043a\:0443"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"vV", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"km", "-", "32"}], ";;", "km"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"strokalen", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"vV", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"km", "-", "32"}], ";;", 
           RowBox[{"km", "-", "22"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"km", "=", 
      RowBox[{"km", "-", "33"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vV", " ", "=", 
      RowBox[{"vV", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "km"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]",
      "km", ";", "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"s", ",", 
         RowBox[{"FromCharacterCode", "[", 
          RowBox[{"FromDigits", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Partition", "[", 
              RowBox[{"vV", ",", "11"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "vV", "]"}], "/", "11"}], ")"}], "-", 
          "strokalen", "+", "1"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", "vV", "]"}], "/", "11"}]}], "}"}]}], "]"}], 
     ";", 
     RowBox[{"StringJoin", "[", "s", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"d361f663-2ced-4e7f-97c3-0389aa2f6548"]
},
WindowSize->{952, 1021},
WindowMargins->{{Automatic, 3}, {Automatic, 2}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 426, 6, 34, "Text",ExpressionUUID->"0a5df797-6776-45cb-a80e-af2d54f1985e"],
Cell[987, 28, 7191, 211, 360, "Input",ExpressionUUID->"147384ef-a799-43af-86bc-ddb0d74a076c"],
Cell[8181, 241, 320, 5, 34, "Text",ExpressionUUID->"5467a3ed-b619-41fe-aa87-c54ebd4dfabc"],
Cell[8504, 248, 12812, 271, 960, "Input",ExpressionUUID->"a512d29f-7a75-42b1-924d-1e915e6da8d8"],
Cell[21319, 521, 372, 6, 34, "Text",ExpressionUUID->"b88f586a-2f60-49cd-a36e-4c2599afea70"],
Cell[21694, 529, 1131, 32, 67, "Input",ExpressionUUID->"4c099512-6c28-4382-a1fb-65191e0e99ef"],
Cell[22828, 563, 340, 5, 34, "Text",ExpressionUUID->"de4c854d-f59d-4f87-8e75-e5410df9d199"],
Cell[23171, 570, 2111, 56, 200, "Input",ExpressionUUID->"5b54f902-3ef4-4a6f-8843-b652f857ba47"],
Cell[25285, 628, 502, 7, 34, "Text",ExpressionUUID->"832a1aff-0593-4f52-811f-5e6f432768aa"],
Cell[25790, 637, 3916, 96, 352, "Input",ExpressionUUID->"a7a46304-2389-4bbf-9896-fa788dbcf092"],
Cell[29709, 735, 371, 6, 34, "Text",ExpressionUUID->"4eefed9c-d99a-49ee-9383-0d763e259916"],
Cell[30083, 743, 18349, 462, 1340, "Input",ExpressionUUID->"1b29c734-6af2-4b35-b716-380160bab11b"],
Cell[48435, 1207, 322, 5, 34, "Text",ExpressionUUID->"b5050101-69de-43fa-927f-8b08c53bb1b4"],
Cell[48760, 1214, 13109, 319, 903, "Input",ExpressionUUID->"d361f663-2ced-4e7f-97c3-0389aa2f6548"]
}
]
*)

